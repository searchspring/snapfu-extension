(function(){"use strict";const e={settings:{enabled:!1,intercepts:"*://snapui.searchspring.io/*/bundle.js*\n*://cdn.searchspring.net/search/v3/js/searchspring.catalog.js*\n*://cdn.searchspring.net/search/v3/lts/searchspring.catalog.js*"},bundle:{url:"https://localhost:3333/bundle.js",context:"shopper = {\n  id: 'snapdev'\n};",mergeContext:!0}},t=async()=>{const t=await chrome.storage.sync.get();return"undefined"!=typeof t?.bundle?.url?t:e};async function n(e){const n=await t();if(n.settings.enabled){const t=n.bundle.url,s=n.bundle.context,c=n.bundle.mergeContext,r=Array.from(document.querySelectorAll('script[id^=searchspring], script[src*="snapui.searchspring.io"]'));c||r.forEach((e=>{e.innerHTML=""}));const a=r.sort(((e,t)=>e.innerHTML.length-t.innerHTML.length)).pop(),o=a?.innerHTML,i=Object.values(a?.attributes||{}).reduce(((e,t)=>{const n=["id","src","type","defer","async"],s=t.nodeName,c=a.getAttribute(s);return c&&!n.includes(s)&&(e[s]=c),e}),{});let d=s;if(c&&o&&(d=o+"\n"+s),t){const n=document.createElement("script");n.src=e,n.id="snapfu-script",n.setAttribute("url",t),Object.keys(i).forEach((e=>{n.setAttribute(e,i[e])})),d&&(n.innerHTML=d),(document.head||document.documentElement).appendChild(n)}}}function s(e){if(e){const t=document.createElement("script");t.src=e,t.id="snapfu-scraper",(document.head||document.documentElement).appendChild(t)}}(async function(){chrome.runtime.sendMessage({text:"getTabId"},(async e=>{const t=await chrome.storage.local.get();e&&t[e]&&delete t[e],await chrome.storage.local.set(t),document.addEventListener("snapfu-scrape",(async t=>{const n=t.detail,s=await chrome.storage.local.get();e&&(s[e]=n,chrome.storage.local.set(s))}))})),n(chrome.runtime.getURL("/js/loader.js")),s(chrome.runtime.getURL("/js/scraper.js"))})()})();