(function(){"use strict";const e={settings:{enabled:!1,intercepts:"*://snapui.searchspring.io/*/bundle.js*\n*://cdn.searchspring.net/search/v3/js/searchspring.catalog.js*\n*://cdn.searchspring.net/search/v3/lts/searchspring.catalog.js*"},bundle:{url:"https://localhost:3333/bundle.js",context:"shopper = {\n  id: 'snapdev'\n};",mergeContext:!0}},n=async()=>{const n=await chrome.storage.sync.get();return"undefined"!=typeof n?.bundle?.url?n:e},t=async()=>{const e={active:!0,currentWindow:!0},[n]=await chrome.tabs.query(e);return`${n.id}`||void 0};async function s(){const e=await n();c(e),a(e)}function a(e){e.settings.enabled?chrome.action.setIcon({path:{48:"../assets/icons/snapfu48_on.png",128:"../assets/icons/snapfu128_on.png"}}):chrome.action.setIcon({path:{48:"../assets/icons/snapfu48.png",128:"../assets/icons/snapfu128.png"}})}function c(e){const n=e.settings.intercepts.split("\n")?.filter((e=>!!e.length&&e.trim())),t=n.map(((e,n)=>({id:n+1,priority:n+1,action:{type:"block"},condition:{urlFilter:e,resourceTypes:["script"]}})));e.bundle.url&&t.push({id:t.length+1,priority:t.length+1,action:{type:"allow"},condition:{urlFilter:e.bundle.url,resourceTypes:["script"]}}),chrome.declarativeNetRequest.getDynamicRules((n=>{const s=n.map((e=>e.id)),a=e.settings.enabled?t:[];chrome.declarativeNetRequest.updateDynamicRules({addRules:a,removeRuleIds:s||[]})}))}async function r(){const e=await t();if(e)return chrome.tabs.reload(Number(e))}s(),chrome.storage.onChanged.addListener((async(e,n)=>{"sync"===n&&(chrome.storage.local.clear(),s(),r())})),chrome.runtime.onMessage.addListener((function(e,n,t){"getTabId"==e.text&&n?.tab?.id&&t(n.tab.id)}))})();